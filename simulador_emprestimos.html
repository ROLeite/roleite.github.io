<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulador: Regressão Logística (Empréstimo PJ)</title>
  <style>
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;line-height:1.4;background:#f6f8fa;color:#111;margin:0;padding:24px}
    .container{max-width:900px;margin:0 auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 6px 20px rgba(16,24,40,.08)}
    h1{margin:0 0 12px;font-size:20px}
    p.lead{color:#4b5563;margin:0 0 18px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .feature{border:1px solid #e6e9ef;padding:12px;border-radius:8px;display:flex;gap:8px;align-items:center}
    .controls{display:flex;gap:8px;align-items:center;margin-top:16px}
    .btn{background:#0b69ff;color:#fff;padding:10px 14px;border-radius:8px;border:0;cursor:pointer}
    .btn.secondary{background:#eef2ff;color:#0b69ff}
    .results{margin-top:18px}
    .progress{height:12px;background:#eef2ff;border-radius:8px;overflow:hidden}
    .progress > span{display:block;height:100%;width:0;background:#0b69ff;border-radius:8px}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px;text-align:left;border-bottom:1px solid #eef2ff}
    .metric{display:inline-block;padding:6px 10px;border-radius:999px;background:#f3f4f6;margin-right:8px}
    .small{font-size:13px;color:#6b7280}
    .note{margin-top:12px;color:#6b7280;font-size:13px}
    footer{margin-top:18px;font-size:13px;color:#9ca3af}
  </style>
</head>
<body>
  <div class="container">
    <h1>Simulador de Regressão Logística — Empréstimo PJ</h1>
    <h1>Disciplina de Gestão de Riscos, COPPEAD Finanças — Prof. Rodrigo Leite</h1>
    <p class="lead">Selecione as features que deseja incluir no modelo. O site simula o cálculo de uma <strong>regressão logística</strong> em que a variável dependente é a probabilidade de default (1= default, 0 = não default) e retorna os coeficientes (betas), seus <strong>p-valores</strong> e as métricas <strong>AUC</strong> e <strong>F1 score</strong>. (Resultados simulados)</p>

    <div class="grid">
      <div>
        <div class="feature"><input type="checkbox" id="feat_tam_emprestimo" checked><label for="feat_tam_emprestimo">Tamanho do empréstimo</label></div>
        <div class="feature"><input type="checkbox" id="feat_score_serasa" checked><label for="feat_score_serasa">Score Serasa do sócio administrador</label></div>
        <div class="feature"><input type="checkbox" id="feat_capital_social" checked><label for="feat_capital_social">Capital social</label></div>
        <div class="feature"><input type="checkbox" id="feat_num_func" checked><label for="feat_num_func">Número de funcionários</label></div>
      </div>
      <div>
        <div class="feature"><input type="checkbox" id="feat_receita" checked><label for="feat_receita">Receita (último período)</label></div>
        <div class="feature"><input type="checkbox" id="feat_lucro" checked><label for="feat_lucro">Lucro (último período)</label></div>
        <div class="feature"><input type="checkbox" id="feat_caixa" checked><label for="feat_caixa">Caixa disponível</label></div>
        <div class="controls">
          <button class="btn" id="runBtn">Rodar regressão logística</button>
          <button class="btn secondary" id="resetBtn">Resetar seleção</button>
        </div>
      </div>
    </div>

    <div class="results" id="results" style="display:none">
      <h3>Resultados (simulados)</h3>
      <div class="small" id="infoRun">Estimando modelo...</div>
      <div style="margin-top:8px" class="progress"><span id="bar"></span></div>

      <div id="metrics" style="display:none;margin-top:12px">
        <div style="margin-bottom:8px">
          <span class="metric" id="aucBadge">AUC: —</span>
          <span class="metric" id="f1Badge">F1 score: —</span>
        </div>

        <h4>Coeficientes estimados (Betas) e p-valores</h4>
        <table id="betaTable"><thead><tr><th>Feature</th><th>Beta</th><th>p-valor</th></tr></thead><tbody></tbody></table>

        <p class="note">Observação: estes valores são <strong>simulados</strong> e servem apenas para fins educacionais. O site simula o processo de estimação de uma regressão logística e o cálculo de métricas de desempenho (AUC e F1).</p>
      </div>
    </div>

    <footer>(c) 2025 Prof. Rodrigo Leite — Simulação local no navegador (sem envio de dados).</footer>
  </div>

  <script>
    const featureData = [
      {id:'tam_emprestimo',label:'Tamanho do empréstimo',beta:1.25,pval:0.012,significativa:true},
      {id:'score_serasa',label:'Score Serasa',beta:0.35,pval:0.624,significativa:false},
      {id:'capital_social',label:'Capital social',beta:-0.28,pval:0.731,significativa:false},
      {id:'num_func',label:'Número de funcionários',beta:0.41,pval:0.582,significativa:false},
      {id:'receita',label:'Receita (último período)',beta:-1.05,pval:0.021,significativa:true},
      {id:'lucro',label:'Lucro (último período)',beta:-0.93,pval:0.037,significativa:true},
      {id:'caixa',label:'Caixa disponível',beta:-1.10,pval:0.018,significativa:true}
    ];

    document.getElementById('runBtn').addEventListener('click',()=>{
      const selected = featureData.filter(f=>document.getElementById('feat_'+f.id).checked);
      if(selected.length===0){alert('Selecione ao menos uma feature.');return}

      document.getElementById('results').style.display='block';
      document.getElementById('metrics').style.display='none';
      const bar = document.getElementById('bar');
      bar.style.width='0%';
      document.getElementById('infoRun').innerText='Estimando regressão logística (simulado)...';

      let prog=0;
      const progInterval = setInterval(()=>{
        prog += Math.random()*15+5;
        if(prog>98)prog=98;
        bar.style.width = prog + '%';
      },180);

      setTimeout(()=>{
        clearInterval(progInterval);
        bar.style.width='100%';
        document.getElementById('infoRun').innerText='Regressão logística concluída (simulada)';

        const totalSignificativas = featureData.filter(f=>f.significativa).length;
        const significativasSelecionadas = selected.filter(f=>f.significativa).length;
        const significativasPerdidas = totalSignificativas - significativasSelecionadas;

        // Cálculo exponencial de queda nas métricas
        let baseAUC = 0.87;
        let baseF1 = 0.75;
        const fator = Math.pow(0.85, significativasPerdidas);
        const auc = baseAUC * fator ;
        const f1 = baseF1 * fator ;

        const tbody = document.querySelector('#betaTable tbody');
        tbody.innerHTML='';
        for(const r of selected){
          const tr = document.createElement('tr');
          const tdA = document.createElement('td'); tdA.innerText = r.label;
          const tdB = document.createElement('td'); tdB.innerText = r.beta.toFixed(2);
          const tdC = document.createElement('td'); tdC.innerText = r.pval.toFixed(3);
          tr.appendChild(tdA);tr.appendChild(tdB);tr.appendChild(tdC);
          tbody.appendChild(tr);
        }

        document.getElementById('aucBadge').innerText = 'AUC: ' + auc.toFixed(3);
        document.getElementById('f1Badge').innerText = 'F1 score: ' + f1.toFixed(3);
        document.getElementById('metrics').style.display='block';
      },2200);
    });

    document.getElementById('resetBtn').addEventListener('click',()=>{
      document.querySelectorAll('input[type=checkbox]').forEach(cb=>cb.checked=true);
      document.getElementById('results').style.display='none';
    });
  </script>
</body>
</html>


